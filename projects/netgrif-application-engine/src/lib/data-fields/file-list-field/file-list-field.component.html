<nae-data-field-template *ngIf="!dataField.behavior.hidden"
                         [dataField]="dataField"
                         [dataFieldTemplate]="dataFieldTemplate">
</nae-data-field-template>

<ng-template #dataFieldTemplate let-showLargeLayout="showLargeLayout">
    <div>
        <mat-label *ngIf="!showLargeLayout.value">
            {{dataField.title}}
            <nae-required-label *ngIf="dataField.behavior.required" [isIn]="!dataField.disabled"></nae-required-label>
            <br>
        </mat-label>
        <div fxLayout="column" fxLayoutAlign="start none">
            <div fxLayout="row" fxLayoutAlign="start center" class="margin-bottom-default">
                <div fxFlex="20">
                    <button mat-stroked-button color="primary" (click)="chooseFile()" *ngIf="!formControl.disabled"
                            [class.do-not-click]="state.uploading" fxFlex>
                        <mat-icon>file_upload</mat-icon>
                    </button>
                </div>
                <div fxFlex="5"></div>
                <div fxLayout="column" fxFlex="75">
                    <div fxFlex="100" *ngIf="uploadedFiles.length === 0">
                        <button mat-button color="accent" fxFlex="100">
                            {{constructDisplayName()}}
                        </button>
                    </div>
                    <div fxLayout="column" fxFlex="100" *ngIf="uploadedFiles.length !== 0">
                        <div *ngFor="let name of uploadedFiles">
                            <button mat-button class="file-button" color="{{dataField.downloaded.includes(name) ? 'primary' : 'accent'}}" (click)="download(name)" matTooltip="Click to download {{name}}" fxFlex="95">
                                <mat-icon *ngIf="state.completed && !state.error" color="accent">done</mat-icon>
                                <mat-icon *ngIf="state.completed && state.error" color="warn">error</mat-icon>
                                {{name}}
                            </button>
                            <button mat-button [disabled]="formControl.disabled" fxFlex="5">
                                <mat-icon color="warn" (click)="deleteFile(name)" matTooltip="Click to delete">close</mat-icon>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <mat-progress-bar *ngIf="state.uploading || state.downloading" color="primary" [value]="state.progress"
                              [mode]="state.uploading ? 'determinate' : 'indeterminate'"
                              class="margin-bottom-default"></mat-progress-bar>
        </div>
        <input type="file" #fileUploadInput name="fileUpload" [multiple]="true"
               accept="{{dataField.allowTypes}}" class="invisible-input"/>
        <input type="hidden" [formControl]="formControl" [multiple]="true" accept="{{dataField.allowTypes}}">
        <mat-error *ngIf="!formControl.valid && formControl.touched">{{'dataField.validations.required' | translate}}</mat-error>
    </div>
</ng-template>
