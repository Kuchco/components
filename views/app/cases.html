<div ng-cloak>

	<md-tabs md-dynamic-height md-autoselect="true" md-border-bottom md-selected="caseCtrl.activeTabIndex" class="background-tabs">

		<md-tab md-on-select="caseCtrl.caseTab.activate()" class="primary">

			<md-tab-label>
				{{::$i18n.page.cases.my}}
			</md-tab-label>

			<md-tab-body>
				<md-content layout="column" class="color-bg-transparent padding-2x">

					<div layout="row" layout-align="space-between center" class="card padding-horizontal-2x">

						<md-input-container flex-gt-xs="30" flex-xs class="md-block">
							<md-icon class="material-icons color-fg-primary-500">search</md-icon>
							<label>{{::$i18n.block.input.search}}</label>
							<input type="text" ng-model="caseCtrl.search" title="Search input">
						</md-input-container>

						<md-button class="md-fab md-raised md-mini md-primary" ng-click="caseCtrl.caseTab.openNewCaseDialog($i18n.page.cases.this)">
							<md-icon class="material-icons">add</md-icon>
							<md-tooltip md-direction="left">
								{{::$i18n.block.add.createCase}}
							</md-tooltip>
						</md-button>

					</div>

					<md-divider class="border-width-2x color-border-transparent"></md-divider>

					<div flex layout="column">

						<div layout="row" layout-align="start center" class="card height-48px padding-horizontal-2x">

							<span flex-gt-sm="10" flex-sm="15" flex-xs="30">
								{{::$i18n.block.case.header.label}}
								<md-icon class="material-icons">
                					{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
            					</md-icon>
							</span>
							<span flex-gt-md="20" flex-gt-sm="25" flex-sm="30" flex-xs="50">
								{{::$i18n.block.case.header.visualID}}
								<md-icon class="material-icons">
                					{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
            					</md-icon>
							</span>
							<span hide hide-xs show-gt-xs flex-gt-md="20" flex-md="30" flex-sm="45">
								{{::$i18n.block.case.header.title}}
								<md-icon class="material-icons">
                					{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
            					</md-icon>
							</span>
							<span hide show-gt-sm flex-gt-md="20" flex-gt-sm="25">
								{{::$i18n.block.case.header.author}}
								<md-icon class="material-icons">
                					{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
            					</md-icon>
							</span>
							<span hide show-gt-md flex="20">
								{{::$i18n.block.case.header.createDate}}
								<md-icon class="material-icons">
                					{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
            					</md-icon>
							</span>

							<div flex-gt-xs="10" flex-xs="20"></div> <!-- Menu -->

						</div>

						<md-divider class="border-width-2x color-border-transparent"></md-divider>

						<div layout="column" class="card">

							<div layout="row" layout-align="start center" ng-repeat-start="useCase in caseCtrl.caseTab.cases | orderBy:'strindId'" ng-click="useCase.open()" class="card-case padding-horizontal-2x">

								<i flex-gt-sm="10" flex-sm="15" flex-xs="30" class="material-icons {{::useCase.color}}">
									{{useCase.icon ? useCase.icon : 'label'}}
								</i>
								<span flex-gt-md="20" flex-gt-sm="25" flex-gt-xs="30" flex-xs="50">
									{{::useCase.visualId}}
								</span>
								<span hide hide-xs show-gt-xs flex-gt-md="20" flex-md="30" flex-sm="45">
									{{::useCase.title}}
								</span>
								<span hide show-gt-sm flex-gt-md="20" flex-gt-sm="25" layout="row" layout-align="start center">
									<i class="material-icons color-fg-primary-500 margin-right-2x">account_circle</i>
                					Name Surname
								</span>
								<span hide show-gt-md flex="20">
									dd.mm.yyyy hh:mm
								</span>

								<md-menu flex-gt-xs="10" flex-xs="20" layout="row" layout-align="end center">
									<md-button class="md-icon-button" ng-click="$mdMenu.open($event)" md-menu-origin>
										<md-icon class="material-icons">more_vert</md-icon>
									</md-button>
									<md-menu-content>
										<md-menu-item>
											<md-button ng-click="useCase.delete()">
												<md-icon class="material-icons">delete</md-icon>
												<span>{{$i18n.block.btn.delete}}</span>
											</md-button>
										</md-menu-item>
									</md-menu-content>
								</md-menu>

							</div>

							<md-divider ng-class="$last ? 'hide' : ''" ng-repeat-end></md-divider>

						</div>

					</div>

					<div layout="row" layout-sm="column" layout-align="center center" class="padding-2x margin-2x" in-view="$inview&&caseCtrl.caseTab.load(true)" in-view-options="{ throttle: 0 }">
						<md-progress-circular md-mode="indeterminate" ng-disabled="!caseCtrl.caseTab.loading" class="progress-circular-stroke-accent-50" md-diameter="50"></md-progress-circular>
					</div>

				</md-content>
			</md-tab-body>
		</md-tab>

		<md-tab class="primary" ng-repeat="tab in caseCtrl.taskTabs" md-on-select="caseCtrl.tabChanged()">

			<md-tab-label>
				{{::tab.useCase.title}}
				<md-icon class="material-icons cursor-pointer font-size-22" ng-click="caseCtrl.closeTab(tab.useCase.stringId)">close</md-icon>
			</md-tab-label>

			<md-tab-body>
				<md-content layout="column" class="color-bg-transparent padding-2x">

					<div flex layout="row" layout-align="space-around center" class="card height-48px padding-horizontal-2x">

						<span ng-repeat="trans in tab.transactions | orderBy:'stringId'" ng-class="trans.active ? 'active' : ''" class="transaction">
							{{::trans.title}}
						</span>

					</div>

					<md-divider class="border-width-2x color-border-transparent"></md-divider>

					<div layout="row" layout-align="start center" class="card height-48px padding-horizontal-2x">

						<a flex-gt-md="20" flex-gt-sm="25" flex-gt-xs="35" flex-xs="30" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('caseTitle')">
							{{::$i18n.block.task.header.case}}
							<md-icon class="material-icons">
								{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
							</md-icon>
						</a>
						<a flex-gt-md="20" flex-gt-sm="25" flex-gt-xs="45" flex-xs="50" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('title')">
							{{::$i18n.block.task.header.title}}
							<md-icon class="material-icons">
								{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
							</md-icon>
						</a>
						<a hide hide-xs show-gt-xs flex-gt-md="10" flex-gt-sm="15" flex-gt-xs="20" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('priority')">
							{{::$i18n.block.task.header.priority}}
							<md-icon class="material-icons">
								{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
							</md-icon>
						</a>
						<a hide show-gt-sm flex-gt-md="20" flex-gt-sm="25" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('username')">
							{{::$i18n.block.task.header.user}}
							<md-icon class="material-icons">
								{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
							</md-icon>
						</a>
						<a hide show-gt-md flex="20" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('startDate')">
							{{::$i18n.block.task.header.assignDate}}
							<md-icon class="material-icons">
								{{TODO.tasksCtrl.sort.expresion == 'TODO' && !TODO.tasksCtrl.sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down'}}
							</md-icon>
						</a>
						<div flex-gt-xs="10" flex-xs="20"></div> <!-- Done Icon / Menu / Loader -->

					</div>

					<md-divider class="border-width-2x color-border-transparent"></md-divider>

					<md-expansion-panel-group md-component-id="'tasksGroup-'+tab.id" eval-attr-as-expr="mdComponentId" multiple></md-expansion-panel-group>

					<div layout="row" layout-align="center center" class="padding-2x margin-2x">
						<md-progress-circular md-mode="indeterminate" ng-disabled="!tab.loading" class="progress-circular-stroke-accent-50" md-diameter="50"></md-progress-circular>
					</div>

				</md-content>
			</md-tab-body>

		</md-tab>

	</md-tabs>
</div>