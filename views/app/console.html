<div ng-cloak>

    <div class="background-default background-fullpage-tabs"></div>

    <md-tabs md-dynamic-height md-autoselect="true" md-border-bottom>

        <md-tab md-on-select="adminCtrl.loadOrganizations()">

            <md-tab-label>
                {{::$i18n.page.console.inviteUser}}
            </md-tab-label>

            <md-tab-body>
                <md-content class="md-padding color-bg-transparent" layout="column">

                    <div layout="row">

                        <div flex>

                            <md-toolbar class="card padding-vertical-2x">
                                <div layout="row" layout-align="space-between center" class="md-toolbar-tools">

                                    <span>{{::$i18n.page.console.newUser}}</span>

                                    <ng-form name="invitationForm">
                                        <md-input-container class="input-container-fixed-height-padding-0">
                                            <label>{{::$i18n.block.invite.email}}</label>
                                            <input name="email" ng-model="adminCtrl.invitedUser.email" type="email"
                                                   required>
                                            <div ng-messages="invitationForm.email.$error">
                                                <div ng-message="email">{{::$i18n.block.validation.email}}</div>
                                                <div ng-message="required">{{::$i18n.block.validation.required}}</div>
                                            </div>
                                        </md-input-container>
                                    </ng-form>

                                </div>
                            </md-toolbar>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <div flex layout="column" layout-align="center start" class="card padding-2x">

                                <span class="margin-bottom-default">{{::$i18n.page.console.orgs}}</span>

                                <md-list flex class="padding-0 layout-rw-100">
                                    <md-list-item ng-repeat="org in adminCtrl.invitedUser.organizations"
                                                  class="list-item border-radius-default"
                                                  ng-click="null">
                                        <div flex layout="row" layout-align="space-between center">
                                            <span>{{org.name}}</span>
                                            <md-button class="md-icon-button" ng-click="org.remove()">
                                                <i class="material-icons color-fg-error">close</i>
                                            </md-button>
                                        </div>
                                    </md-list-item>
                                </md-list>

                            </div>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <div flex layout="column" layout-align="center start" class="card padding-2x">

                                <span class="margin-bottom-default">{{::$i18n.page.console.roles}}</span>

                                <section flex class="layout-rw-100" ng-repeat="(netId, net) in adminCtrl.invitedUser.processRoles">

                                    <md-subheader flex class="color-fg-primary-500 color-bg-transparent">
                                        {{net.title}}
                                    </md-subheader>

                                    <md-list flex class="padding-0">

                                        <md-list-item ng-repeat="role in net.roles" class="list-item border-radius-default" ng-click="null">
                                            <div flex layout="row" layout-align="space-between center">
                                                <span>{{role.name}}</span>
                                                <md-button class="md-icon-button" ng-click="role.remove(netId)">
                                                    <i class="material-icons color-fg-error">close</i>
                                                </md-button>
                                            </div>
                                        </md-list-item>

                                    </md-list>

                                    <md-divider ng-if="!$last"></md-divider>

                                </section>
                            </div>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <div flex layout="row" layout-align="end center" class="card padding-vertical-2x">
                                <md-progress-circular md-mode="indeterminate"
                                                      class="progress-circular-stroke-accent-50 margin-left-default"
                                                      md-diameter="30"
                                                      ng-if="adminCtrl.inviteLoading">
                                </md-progress-circular>
                                <md-button class="md-primary" ng-click="adminCtrl.invite()" layout="row" layout-align="center center">
                                    <md-icon class="material-icons margin-horizontal-0 margin-right-default">person_add</md-icon>
                                    {{::$i18n.block.btn.invite}}
                                </md-button>
                            </div>

                        </div>

                        <md-divider class="border-width-default color-border-transparent"></md-divider>

                        <div flex>

                            <md-toolbar class="card padding-vertical-2x">
                                <div layout="row" layout-align="start center" class="md-toolbar-tools">

                                    <span>{{::$i18n.page.console.orgs}}</span>

                                </div>
                            </md-toolbar>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <md-list flex class="padding-0">

                                <md-list-item ng-repeat-start="org in adminCtrl.organizations" class="card list-item" ng-click="org.add()">
                                    <div flex layout="row" layout-align="space-between center">
                                        <span>{{org.name}}</span>
                                        <md-button class="md-icon-button" ng-click="org.add()">
                                            <i class="material-icons color-fg-success">add</i>
                                        </md-button>
                                    </div>
                                </md-list-item>

                                <md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>

                            </md-list>

                        </div>

                        <md-divider class="border-width-default color-border-transparent"></md-divider>

                        <div flex>

                            <md-toolbar class="card padding-vertical-2x">
                                <div layout="row" layout-align="space-between center" class="md-toolbar-tools">

                                    <span>{{::$i18n.page.console.processRolesLower}}</span>

                                    <md-input-container class="margin-right-default">
                                        <label>Process</label>
                                        <md-select ng-model="adminCtrl.selectedNet"
                                                   ng-change="adminCtrl.loadProcessRoles()">
                                            <md-option ng-repeat="process in processes"
                                                       ng-value="process"
                                                       ng-selected="$first">
                                                {{process.title}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>

                                </div>
                            </md-toolbar>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <md-list flex class="padding-0">

                                <md-list-item ng-repeat-start="role in adminCtrl.processRoles" class="card list-item"
                                              ng-click="role.add()">
                                    <div flex layout="row" layout-align="space-between center">
                                        <span>{{role.name}}</span>
                                        <md-button class="md-icon-button" ng-click="role.add()">
                                            <i class="material-icons color-fg-success">add</i>
                                        </md-button>
                                    </div>
                                </md-list-item>

                                <md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>

                            </md-list>

                        </div>

                    </div>

                </md-content>
            </md-tab-body>

        </md-tab>

        <md-tab>

            <md-tab-label>
                {{::$i18n.page.console.processRoles}}
            </md-tab-label>

            <md-tab-body>
                <md-content class="padding-default color-bg-transparent" layout="column" layout-align="center">

                    <div layout="row">

                        <div flex>

                            <md-toolbar class="card padding-vertical-2x">
                                <div layout="row" layout-align="space-between center" class="md-toolbar-tools">

                                    <md-input-container class="input-container-fixed-height-padding-0">
                                        <label>{{::$i18n.block.input.user}}</label>
                                        <input type="text" ng-model="userSearch.input"
                                               ng-change="adminCtrl.filterUsers()">
                                    </md-input-container>

                                    <md-menu>
                                        <md-button ng-click="$mdMenu.open($event)" class="md-icon-button">
                                            <md-icon class="material-icons color-fg-material-grey-text">more_vert</md-icon>
                                        </md-button>

                                        <md-menu-content>
                                            <md-menu-item class="margin-left-2x">
                                                <md-checkbox ng-model="userSearch.byName" aria-label="Name"
                                                             class="md-primary">
                                                    {{::$i18n.block.input.name}}
                                                </md-checkbox>
                                            </md-menu-item>
                                            <md-menu-item class="margin-left-2x">
                                                <md-checkbox ng-model="userSearch.byEmail" aria-label="Email"
                                                             class="md-primary">
                                                    {{::$i18n.block.input.email}}
                                                </md-checkbox>
                                            </md-menu-item>
                                        </md-menu-content>
                                    </md-menu>

                                </div>
                            </md-toolbar>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <md-list flex class="padding-0">

                                <md-list-item ng-repeat-start="user in users | orderBy:user.fullName"
                                              ng-click="adminCtrl.selectUser(user)" class="card list-item"
                                              ng-class="user.selected ? 'list-item-selected' : ''">
                                    <div flex layout="row" layout-align="start center">
                                        <i class="material-icons color-fg-primary-500 margin-right-2x">account_circle</i>
                                        <span>
                                            {{user.fullName}}
                                            <md-tooltip>
                                                {{user.email}}
                                            </md-tooltip>
                                        </span>
                                    </div>
                                </md-list-item>

                                <md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>

                            </md-list>

                        </div>

                        <md-divider class="border-width-default color-border-transparent"></md-divider>

                        <div flex>

                            <md-toolbar class="card padding-vertical-2x">
                                <div layout="row" layout-align="start center" class="md-toolbar-tools">

                                    <md-input-container>
                                        <label>{{::$i18n.block.input.process}}</label>
                                        <md-select ng-model="adminCtrl.roles.process" ng-change="adminCtrl.loadRoles()">
                                            <md-option ng-repeat="process in processes" ng-value="process">
                                                {{process.title}}
                                            </md-option>
                                        </md-select>
                                    </md-input-container>

                                    <md-input-container class="input-container-fixed-height-padding-0">
                                        <label>{{::$i18n.block.input.role}}</label>
                                        <input type="text" ng-model="adminCtrl.roleInput">
                                    </md-input-container>

                                    <span flex></span>

                                    <md-button class="md-primary" ng-click="adminCtrl.saveRoles()">
                                        {{::$i18n.block.btn.save}}
                                    </md-button>

                                    <i ng-hide="saved" class="material-icons color-fg-warning">warning</i>

                                </div>
                            </md-toolbar>

                            <md-divider class="border-width-default color-border-transparent"></md-divider>

                            <md-list flex class="padding-0">

                                <md-list-item ng-repeat-start="role in roles | orderBy:role.name"
                                              ng-click="adminCtrl.selectRole(role)" class="card list-item"
                                              ng-class="role.selected ? 'list-item-selected' : ''">
                                    <div flex layout="row" layout-align="start center">
                                        <i class="material-icons color-fg-primary-500 margin-right-2x">perm_identity</i>
                                        <span>{{role.name}}</span>
                                    </div>
                                </md-list-item>

                                <md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>

                            </md-list>

                        </div>

                    </div>

                </md-content>
            </md-tab-body>

        </md-tab>

    </md-tabs>

</div>