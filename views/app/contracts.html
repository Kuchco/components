<div ng-cloak>

    <md-tabs md-dynamic-height md-autoselect="true" md-border-bottom md-selected="contractCtrl.activeTabIndex">

        <md-tab md-on-select="contractCtrl.caseTab.activate()" class="primary" >

            <md-tab-label>
                {{$i18n.page.contracts.my}}
            </md-tab-label>

            <md-tab-body>
                <md-content layout="column" class="color-bg-transparent">

                    <div layout="row" layout-align="start center" class="card padding-2x margin-default" flex>

                        <div flex-gt-sm="30" flex-sm flex-xs layout="row" layout-align="start center">
                            <i class="material-icons color-fg-accent-50">search</i>

                            <md-input-container class="margin-0 height-52px">
                                <label>{{::$i18n.block.input.search}}</label>
                                <input type="text" ng-model="contractCtrl.search" class="margin-bottom-negative-15px">
                            </md-input-container>
                        </div>

                    </div>

                    <div layout="column" class="card margin-default" flex>

                        <div layout="row" layout-align="start center" class="card-header list-header padding-default padding-horizontal-2x">
                            <span flex-gt-xs="10" flex-xs="20">{{::$i18n.block.case.label}}</span>
                            <span flex="20" hide show-gt-sm>{{::$i18n.block.case.visualID}}</span>
                            <span flex-gt-sm="25" flex-sm flex-xs>{{::$i18n.block.case.title}}</span>
                            <span flex ng-repeat="data in contractCtrl.caseTab.cases[0].immediateData | orderBy:'order'">
                                <md-tooltip md-direction="top">{{data.description}}</md-tooltip>
                                {{data.name}}
                            </span>
                            <span flex-gt-sm flex-sm-none flex-xs-none></span>
                            <span flex="5" class="visibility-hidden"></span>
                        </div>

                        <div layout="row" layout-align="start center" class="padding-default padding-horizontal-2x list-item"
                             ng-repeat-start="useCase in contractCtrl.caseTab.cases | orderBy:'strindId'"
                             ng-click="useCase.open()">
                            <i flex-gt-xs="10" flex-xs="20" class="material-icons {{::useCase.color}}">{{useCase.icon ? useCase.icon : 'label'}}</i>
                            <span flex="20" hide show-gt-sm>{{::useCase.visualId}}</span>
                            <span flex-gt-sm="25" flex-sm flex-xs>{{::useCase.title}}</span>
                            <span flex ng-repeat="data in useCase.immediateData | orderBy:'order'">
                                {{data.value}}
                            </span>
                            <span flex-gt-sm flex-sm-none flex-xs-none></span>
                            <md-menu flex="5" layout="row" layout-align="start center">
                                <md-button class="md-icon-button" ng-click="$mdOpenMenu($event)" md-menu-origin>
                                    <md-icon class="material-icons color-fg-accent-50">more_vert</md-icon>
                                </md-button>
                                <md-menu-content>
                                    <md-menu-item>
                                        <md-button ng-click="useCase.delete()">{{$i18n.block.btn.delete}}</md-button>
                                    </md-menu-item>
                                </md-menu-content>
                            </md-menu>
                        </div>
                        <md-divider ng-class="$last ? 'hide' : ''" ng-repeat-end></md-divider>

                    </div>

                    <div layout="row" layout-sm="column" layout-align="center center" class="padding-default margin-horizontal-default"
                         in-view="$inview&&contractCtrl.caseTab.load(true)"
                         in-view-options="{ throttle: 0 }">
                        <md-progress-circular md-mode="indeterminate" ng-disabled="!contractCtrl.caseTab.loading" class="md-primary" md-diameter="50"></md-progress-circular>
                    </div>

                </md-content>
            </md-tab-body>
        </md-tab>

        <md-tab class="primary" ng-repeat="tab in contractCtrl.taskTabs" md-on-select="contractCtrl.tabChanged()">

            <md-tab-label>
                {{::tab.useCase.title}}
                <md-icon class="material-icons cursor-pointer font-size-22" ng-click="contractCtrl.closeTab(tab.useCase.stringId)">close</md-icon>
            </md-tab-label>

            <md-tab-body>
                <md-content layout="column" class="color-bg-transparent">

                    <div layout="column" class="card padding-vertical-2x padding-horizontal-2x margin-default margin-top-default">

                        <div layout="row" layout-align="space-between center" flex>

                            <span ng-repeat="trans in tab.transactions | orderBy:'stringId'"
                                  ng-class=" trans.active ? 'active' : '' " class="font-size-18">
								{{::trans.title}}
							</span>

                        </div>

                    </div>

                    <div layout="row" class="card color-bg-black-op-40 margin-default padding-2x">
                        <span flex="10">{{::$i18n.block.task.label}}</span>
                        <span flex="40">{{::$i18n.block.task.contract}}</span>
                        <span flex="40">{{::$i18n.block.task.title}}</span>
                        <span flex="10">{{::$i18n.block.task.status}}</span>
                    </div>

                    <md-expansion-panel-group md-component-id="'tasksGroup-'+tab.id" eval-attr-as-expr="mdComponentId" multiple>
                    </md-expansion-panel-group>

                    <div layout="row" layout-sm="column" layout-align="center center" class="padding-default margin-horizontal-2x">
                        <md-progress-circular md-mode="indeterminate" ng-disabled="!tab.loading" class="md-primary" md-diameter="50"></md-progress-circular>
                    </div>

                </md-content>
            </md-tab-body>

        </md-tab>

    </md-tabs>

</div>