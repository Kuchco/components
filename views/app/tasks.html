<div ng-cloak>

    <md-tabs md-dynamic-height md-autoselect="true" md-border-bottom md-selected="tasksCtrl.activeTab" class="background-tabs">

        <md-tab ng-repeat="tab in tasksCtrl.tabs" label="{{tab.label}}" md-on-select="tasksCtrl.tabChanged()">
            <md-content class="md-padding color-bg-transparent">

                <md-card class="search-header" layout="row">

                    <div flex layout="column">

                        <div layout="row" layout-align="left end">

                            <md-icon flex="5" class="material-icons md-primary">search</md-icon>

                            <form flex layout="row" ng-submit="">

                                <md-autocomplete class="md-block autocomplete"
                                                 md-search-text="tasksCtrl.tabs[$index].filter.selectedProcess.search"
                                                 md-selected-item="tasksCtrl.tabs[$index].filter.selectedProcess.item"
                                                 md-selected-item-change="tasksCtrl.processSearchChange(item)"
                                                 md-items="item in tasksCtrl.queryProcesses()"
                                                 md-item-text="item.title"
                                                 md-min-length="0"
                                                 md-no-cache="true"
                                                 md-floating-label="{{::$i18n.block.taskFilter.process}}">

                                    <md-item-template>
                                        <span md-highlight-text="tasksCtrl.tabs[$index].filter.selectedProcess.search" md-highlight-flags="i">
                                            {{item.title}}
                                        </span>
                                    </md-item-template>

                                    <md-not-found>
                                        {{::$i18n.block.taskFilter.process + " " + tasksCtrl.tabs[$index].filter.selectedProcess.search + " " + $i18n.block.task.notFound}}
                                    </md-not-found>

                                </md-autocomplete>

                                <md-autocomplete class="md-block autocomplete"
                                                 md-search-text="tasksCtrl.tabs[$index].filter.selectedTransition.search"
                                                 md-selected-item="tasksCtrl.tabs[$index].filter.selectedTransition.item"
                                                 md-selected-item-change="tasksCtrl.transitionSearchChange(item)"
                                                 md-items="item in tasksCtrl.queryTransitions()"
                                                 md-item-text="item.title"
                                                 md-min-length="0"
                                                 md-no-cache="true"
                                                 md-floating-label="{{::$i18n.block.taskFilter.task}}">

                                    <md-item-template>
                                        <span md-highlight-text="tasksCtrl.tabs[$index].filter.selectedTransition.search" md-highlight-flags="i">
                                            {{item.title}}
                                        </span>
                                    </md-item-template>

                                    <md-not-found>
                                        {{::$i18n.block.taskFilter.task + " " + tasksCtrl.tabs[$index].filter.selectedTransition.search + " " + $i18n.block.task.notFound}}
                                    </md-not-found>

                                </md-autocomplete>

                            </form>

                        </div>

                        <div layout="row" layout-align="left center">

                            <md-icon flex="5" class="material-icons md-primary">filter_list</md-icon>

                            <md-chips ng-model="tasksCtrl.tabs[$index].filter.chips" readonly="true" md-removable="true"
                                      md-on-remove="tasksCtrl.removeChip($chip)"
                                      id="chips-container" flex>
                                <md-chip-template>
                                    {{$chip.title}}
                                </md-chip-template>
                            </md-chips>

                        </div>

                    </div>

                    <div layout="column" layout-align="center center">

                        <div class="padding-no" layout="row" layout-align="center center">

                            <md-button class="md-primary" ng-click="tasksCtrl.searchTasks()">
                                {{$i18n.block.taskFilter.search}}
                            </md-button>

                            <md-menu>
                                <md-button class="md-icon-button" ng-click="$mdOpenMenu($event)" md-menu-origin>
                                    <md-icon class="material-icons">more_vert</md-icon>
                                </md-button>
                                <md-menu-content>
                                    <md-menu-item>
                                        <md-button ng-click="tasksCtrl.showFilterDialog()">{{::$i18n.block.taskFilter.save}}
                                        </md-button>
                                    </md-menu-item>
                                    <md-menu-item>
                                        <md-button ng-click="tasksCtrl.clearFilter()">{{::$i18n.block.taskFilter.reset}}</md-button>
                                    </md-menu-item>
                                </md-menu-content>
                            </md-menu>

                        </div>

                    </div>

                </md-card>

                <div class="tasks">

                    <md-card class="tasks-header" layout="column">

                        <md-card-content layout="row" layout-align="left center">
                            <a flex="25" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('caseTitle')">
                                {{::$i18n.block.taskHeader.case}}
                                <md-icon class="material-icons">{{ tasksCtrl.tabs[$index].sort.field == 'caseTitle' &&
                                    !tasksCtrl.tabs[$index].sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down' }}
                                </md-icon>
                            </a>
                            <a flex="25" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('title')">
                                {{::$i18n.block.taskHeader.name}}
                                <md-icon class="material-icons">{{ tasksCtrl.tabs[$index].sort.field == 'title' &&
                                    !tasksCtrl.tabs[$index].sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down' }}
                                </md-icon>
                            </a>
                            <a flex="15" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('priority')">
                                {{::$i18n.block.taskHeader.priority}}
                                <md-icon class="material-icons">{{ tasksCtrl.tabs[$index].sort.field == 'priority' &&
                                    !tasksCtrl.tabs[$index].sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down' }}
                                </md-icon>
                            </a>
                            <a flex="20" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('username')">
                                {{::$i18n.block.taskHeader.user}}
                                <md-icon class="material-icons">{{ tasksCtrl.tabs[$index].sort.field == 'username' &&
                                    !tasksCtrl.tabs[$index].sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down' }}
                                </md-icon>
                            </a>
                            <a flex="15" href="javascript:void(0)" ng-click="tasksCtrl.setSortField('startDate')">
                                {{::$i18n.block.taskHeader.startDate}}
                                <md-icon class="material-icons">{{ tasksCtrl.tabs[$index].sort.field == 'startDate' &&
                                    !tasksCtrl.tabs[$index].sort.reverse ? 'arrow_drop_up' : 'arrow_drop_down' }}
                                </md-icon>
                            </a>
                            <md-menu>
                                <md-button ng-click="$mdOpenMenu($event)" md-menu-origin>
                                    <md-tooltip md-direction="top">{{::$i18n.block.taskHeader.view.this}}</md-tooltip>
                                    <md-icon class="material-icons">view_carousel</md-icon>
                                </md-button>
                                <md-menu-content>
                                    <md-menu-item>
                                        <md-button ng-click="tasksCtrl.changeView('list')">{{::$i18n.block.taskHeader.view.list}}
                                        </md-button>
                                    </md-menu-item>
                                    <md-menu-item>
                                        <md-button ng-click="tasksCtrl.changeView('table')" disabled>
                                            {{::$i18n.block.taskHeader.view.table}}
                                        </md-button>
                                    </md-menu-item>
                                </md-menu-content>
                            </md-menu>
                        </md-card-content>

                    </md-card>

                    <div ng-include="'views/app/panels/task_view_panel.html'"></div>

                    <div layout="row" layout-sm="column" layout-align="center center" in-view="$inview&&tasksCtrl.loadTasks(true)" in-view-options="{ throttle: 0 }">
                        <md-progress-circular md-mode="indeterminate" ng-disabled="!tasksCtrl.tabs[$index].loading" class="md-primary" md-diameter="60"></md-progress-circular>
                    </div>
                </div>

            </md-content>

        </md-tab>

        <md-tab md-on-select="tasksCtrl.loadFilters()">

            <md-tab-label>
                <md-icon class="material-icons md-highlight">add</md-icon>
            </md-tab-label>

            <md-tab-body>
                <md-content class="md-padding color-bg-transparent" layout="column" layout-align="center">

                    <div layout="row" layout-align="space-between center" class="card card-header padding-2x">

                        <div flex-gt-sm="30" flex-sm flex-xs layout="row" layout-align="start center" class="height-52px">
                            <i class="material-icons color-fg-primary-500">search</i>

                            <md-input-container class="margin-0">
                                <label>{{::$i18n.block.input.search}}</label>
                                <input type="text" ng-model="caseCtrl.search" class="margin-bottom-negative-15px">
                            </md-input-container>

                            <md-menu>

                                <md-button ng-click="$mdMenu.open($event)" class="md-icon-button">
                                    <md-icon class="material-icons color-fg-primary-500">public</md-icon>
                                    <md-tooltip md-direction="right">
                                        {{::$i18n.page.filter.global}}
                                    </md-tooltip>
                                </md-button>

                                <md-menu-content>

                                    <md-menu-item>

                                            <md-button>
                                                <md-icon class="material-icons">public</md-icon>
                                                    <span>{{::$i18n.page.filter.global}}</span>
                                            </md-button>

                                    </md-menu-item>

                                    <md-menu-item>

                                        <md-button>
                                            <md-icon class="material-icons">group</md-icon>
                                                <span>{{::$i18n.page.filter.group}}</span>
                                        </md-button>

                                    </md-menu-item>

                                    <md-menu-item>

                                        <md-button>
                                            <md-icon class="material-icons">person</md-icon>
                                                <span>{{::$i18n.page.filter.personal}}</span>
                                        </md-button>

                                    </md-menu-item>

                                </md-menu-content>

                            </md-menu>
                        </div>

                        <md-button class="md-fab md-raised md-mini md-primary" ng-click="null">
                            <md-icon class="material-icons">done</md-icon>
                            <md-tooltip md-direction="left">
                                {{::$i18n.page.tasks.addTab.submit}}
                            </md-tooltip>
                        </md-button>

                    </div> <!--Search bar-->

                    <div layout="row">

                        <div flex layout="column">

                            <div layout="row" layout-align="start center" class="card card-header height-56px padding-horizontal-2x">
                                <span flex-gt-md="10"  flex-md="10" flex-sm="10" flex-xs="15">{{::$i18n.page.filter.type}}</span>
                                <span flex-gt-md="20" flex-md="40" flex-sm="40" flex-xs="70">{{::$i18n.page.filter.label}}</span>
                                <span flex-gt-md="35" flex-md="40" flex-sm="40" hide-xs>{{::$i18n.page.filter.author}}</span>
                                <span flex-gt-sm="25" hide-md hide-sm hide-xs>{{::$i18n.page.filter.date}}</span>
                                <span flex-gt-md="5" flex-md="10" flex-sm="10" flex-xs="15" class="visibility-hidden"></span>
                            </div> <!--Sort bar-->

                            <md-list flex class="padding-0">

                                <md-list-item class="card list-item list-item-selected">

                                    <div flex layout="row" layout-align="start center">

                                        <span flex-gt-md="10" flex-md="10" flex-sm="10" flex-xs="15" layout="row" layout-align="start center">
                                            <i class="material-icons color-fg-primary-500">group</i>
                                        </span>
                                        <span flex-gt-md="20" flex-md="40" flex-sm="40" flex-xs="70" layout="row" layout-align="start center">Dnesne tasky</span>
                                        <span flex-gt-md="35" flex-md="40" flex-sm="40" hide-xs layout="row" layout-align="start center" class="text-overflow-dots">
                                            <i class="material-icons color-fg-primary-500 margin-right-2x">account_circle</i>
                                             Ing. Veronika Mladoniczká Phd.
                                        </span>
                                        <span flex-gt-sm="25" hide-md hide-sm hide-xs layout="row" layout-align="start center">
                                            16.05.2018 16:27
                                        </span>

                                        <!--<div flex-gt-md="5" hide-sm hide-xs></div>-->

                                        <div flex-gt-md="10" flex-md="10" hide-sm hide-xs layout="row" layout-align="end center" >

                                            <md-button class="md-icon-button color-fg-primary-500">
                                                <i class="material-icons">list</i>
                                                <md-tooltip>
                                                    {{::$i18n.page.filter.tooltips.details}}
                                                </md-tooltip>
                                            </md-button>

                                        </div>

                                        <div hide-gt-sm flex-sm="10" flex-xs="15" layout="row" layout-align="end center" >

                                            <md-button class="md-icon-button color-fg-primary-500" ng-click="taskCtrl.showDialog('filter_detail')">
                                                <i class="material-icons">list</i>
                                                <md-tooltip>
                                                    {{::$i18n.page.filter.tooltips.details}}
                                                </md-tooltip>
                                            </md-button>

                                        </div>

                                    </div>

                                </md-list-item> <!--One filter-->

                                <md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>

                                <md-list-item class="card list-item">

                                <div flex layout="row" layout-align="start center">

                                        <span flex-gt-md="10" flex-md="10" flex-sm="10" flex-xs="15" layout="row" layout-align="start center">
                                            <i class="material-icons color-fg-primary-500">group</i>
                                        </span>
                                    <span flex-gt-md="20" flex-md="40" flex-sm="40" flex-xs="70" layout="row" layout-align="start center">Dnesne tasky</span>
                                    <span flex-gt-md="35" flex-md="40" flex-sm="40" hide-xs layout="row" layout-align="start center" class="text-overflow-dots">
                                            <i class="material-icons color-fg-primary-500 margin-right-2x">account_circle</i>
                                             Ing. Veronika Mladoniczká Phd.
                                        </span>
                                    <span flex-gt-sm="25" hide-md hide-sm hide-xs layout="row" layout-align="start center">
                                            16.05.2018 16:27
                                        </span>

                                    <!--<div flex-gt-md="5" hide-sm hide-xs></div>-->

                                    <div flex-gt-md="10" flex-md="10" hide-sm hide-xs layout="row" layout-align="end center" >

                                        <md-button class="md-icon-button color-fg-primary-500">
                                            <i class="material-icons">list</i>
                                            <md-tooltip>
                                                {{::$i18n.page.filter.tooltips.details}}
                                            </md-tooltip>
                                        </md-button>

                                    </div>

                                    <div hide-gt-sm flex-sm="10" flex-xs="15" layout="row" layout-align="end center" >

                                        <md-button class="md-icon-button color-fg-primary-500" ng-click="taskCtrl.showDialog('filter_detail')">
                                            <i class="material-icons">list</i>
                                            <md-tooltip>
                                                {{::$i18n.page.filter.tooltips.details}}
                                            </md-tooltip>
                                        </md-button>

                                    </div>

                                </div>

                                </md-list-item> <!--One filter-->

                                <md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>
                            </md-list>

                        </div>

                        <md-divider hide-sm hide-xs ng-repeat-end class="border-width-2x color-border-transparent"></md-divider>

                        <div hide-sm hide-xs flex-gt-sm="40" layout="column">

                            <div class="card">

                                <div layout="row" layout-align="space-between center" class="height-56px color-bg-primary-500 border-radius-top-default">

                                    <div class="padding-2x color-fg-accent-50">
                                        <span>{{::$i18n.page.filter.detail}}</span>
                                        <span>Label of selected filter</span>
                                    </div>

                                    <md-button class="md-icon-button">
                                        <md-icon class="material-icons color-fg-accent-50">close</md-icon>
                                    </md-button>

                                </div> <!--Card header first row-->

                                <div flex layout-wrap layout="row" layout-align="start center" class="data-field margin-left-2x margin-top-2x margin-right-2x">

                                    <div flex layout="column">

                                        <div>
                                            <span flex class="data-field-title cursor-pointer">
                                                {{::$i18n.page.filter.process}}
                                                <md-tooltip>
                                                    {{::$i18n.page.filter.tooltips.process}}
                                                </md-tooltip>
                                            </span>

                                            <md-chips class="padding-bottom-default">
                                                <md-chip>
                                                    Reklamacia
                                                </md-chip>
                                            </md-chips>
                                        </div>

                                        <div class="margin-top-default">
                                            <span flex class="data-field-title cursor-pointer">
                                                {{::$i18n.page.filter.transition}}
                                                <md-tooltip>
                                                    {{::$i18n.page.filter.tooltips.transition}}
                                                </md-tooltip>
                                            </span>

                                            <md-chips class="padding-bottom-default">
                                                <md-chip>
                                                    Odvoz
                                                </md-chip>
                                                <md-chip>
                                                    Odovzdat kurierovi
                                                </md-chip>
                                                <md-chip>
                                                    Prijat od kuriera
                                                </md-chip>
                                            </md-chips>
                                        </div>

                                        <md-input-container class="md-block">
                                            <label>{{::$i18n.page.filter.description}}</label>
                                            <textarea ng-model="TODO.description" md-maxlength="150" rows="3" md-select-on-focus></textarea>
                                        </md-input-container>

                                        <div layout="row" layout-align="start center" layout-wrap class="cursor-default">

                                            <div flex="100" layout-wrap layout="row" layout-align="start center">

                                                <div flex="100">

                                                    <div flex layout-wrap layout="row" layout-align="start center" class="data-field margin-bottom-2x" ng-cloak>

                                                        <div flex="20" hide-md>
                                                            <span flex class="data-field-title cursor-pointer">
                                                                {{::$i18n.page.filter.type}}
                                                            </span>
                                                        </div>

                                                        <div flex="5" hide-md></div>

                                                        <div flex="70" flex-md="90" layout="row" layout-align="space-between center" class="padding-vertical-default margin-left-2x">
                                                            <div layout="row" layout-align="start center">
                                                                <i class="material-icons margin-right-2x color-fg-primary-500">group</i>
                                                                <span class="cursor-pointer">
                                                                    {{::$i18n.page.filter.group}}
                                                                </span>
                                                            </div>
                                                        </div>

                                                        <div flex="5" flex-md="10"></div>

                                                    </div>

                                                    <!--<md-divider class="color-border-primary-op-50 margin-bottom-2x"></md-divider>-->

                                                </div> <!-- ./Data-field -->

                                                <div flex="100">

                                                    <div flex layout-wrap layout="row" layout-align="start center" class="data-field margin-bottom-2x" ng-cloak>

                                                        <div flex="20" hide-md>
                                                            <span flex class="data-field-title cursor-pointer">
                                                                {{::$i18n.page.filter.author}}
                                                            </span>
                                                        </div>

                                                        <div flex="5" hide-md></div>

                                                        <div flex="70" flex-md="90" layout="row" layout-align="space-between center" class="padding-vertical-default margin-left-2x">
                                                            <div layout="row" layout-align="start center">
                                                                <i class="material-icons margin-right-2x color-fg-primary-500">account_circle</i>
                                                                <span class="cursor-pointer">
                                                                    Anonymous
                                                                    <md-tooltip>
                                                                        test@email.com
                                                                    </md-tooltip>
                                                                </span>
                                                            </div>
                                                        </div>

                                                        <div flex="5" flex-md="10"></div>

                                                    </div>

                                                    <!--<md-divider class="color-border-primary-op-50 margin-bottom-2x"></md-divider>-->

                                                </div> <!-- ./Data-field -->

                                                <!--<md-divider class="color-border-primary-op-50 margin-bottom-2x"></md-divider>-->

                                                <div flex="100">

                                                    <div flex layout-wrap layout="row" layout-align="start center" class="data-field" ng-cloak>

                                                        <div flex="20" hide-md>
                                                            <span flex class="data-field-title cursor-pointer">
                                                                {{::$i18n.page.filter.date}}
                                                            </span>
                                                        </div>

                                                        <div flex="5" hide-md></div>

                                                        <div flex="70" flex-md="90" layout="row" layout-align="space-between center" class="padding-vertical-default margin-left-2x">
                                                            <div layout="row" layout-align="start center">
                                                                <i class="material-icons margin-right-2x color-fg-primary-500">today</i>
                                                                <span class="cursor-pointer">
                                                                    16.05.2018 16:27
                                                                </span>
                                                            </div>
                                                        </div>

                                                        <div flex="5" flex-md="10"></div>

                                                    </div>

                                                    <!--<md-divider class="color-border-primary-op-50 margin-bottom-2x"></md-divider>-->

                                                </div> <!-- ./Data-field -->

                                            </div>

                                        </div>

                                        <md-divider></md-divider>

                                        <div flex layout="row" layout-align="end center">

                                        <md-button class="md-primary" layout-align="center center">
                                            {{::$i18n.block.btn.save}}
                                        </md-button>

                                        <md-button class="md-primary" layout-align="center center">
                                            {{::$i18n.block.btn.edit}}
                                        </md-button>

                                        <md-button class="md-primary" layout-align="center center">
                                            {{::$i18n.block.btn.delete}}
                                        </md-button>

                                        </div>

                                    </div>

                                </div>

                            </div>

                        </div>

                    </div>

                    <!--<div layout="row"> &lt;!&ndash;FULL SCREEN VERSION&ndash;&gt;-->

                        <!--<div flex layout="column">-->

                            <!--<div layout="row" layout-align="start center" class="card card-header height-56px padding-horizontal-2x">-->
                                <!--<span flex-gt-sm="5"  flex-sm="10" flex-xs="15">{{::$i18n.block.filter.type}}</span>-->
                                <!--<span flex-gt-sm="35" flex-sm="40" flex-xs="70">{{::$i18n.block.filter.label}}</span>-->
                                <!--<span flex-gt-sm="30" flex-sm="40" hide-xs>{{::$i18n.block.filter.author}}</span>-->
                                <!--<span flex-gt-sm="20" hide-sm hide-xs>{{::$i18n.block.filter.date}}</span>-->
                                <!--<span flex-gt-sm="10" flex-sm="10" flex-xs="15" class="visibility-hidden"></span>-->
                            <!--</div> &lt;!&ndash;Sort bar&ndash;&gt;-->

                            <!--<md-list flex class="padding-0">-->

                                <!--<md-list-item class="card list-item">-->

                                    <!--<div flex layout="row" layout-align="start center">-->

                                        <!--<span flex-gt-sm="5" flex-sm="10" flex-xs="15" layout="row" layout-align="start center">-->
                                            <!--<i class="material-icons color-fg-primary-500">group</i>-->
                                        <!--</span>-->
                                        <!--<span flex-gt-sm="35" flex-sm="40" flex-xs="70" layout="row" layout-align="start center">Dnesne tasky</span>-->
                                        <!--<span flex-gt-sm="30" flex-sm="40" hide-xs layout="row" layout-align="start center">-->
                                            <!--<i class="material-icons color-fg-primary-500 margin-right-2x">account_circle</i>-->
                                            <!--Peter pan-->
                                        <!--</span>-->
                                        <!--<span flex-gt-sm="20" hide-sm hide-xs layout="row" layout-align="start center">-->
                                            <!--16.05.2018 16:27-->
                                        <!--</span>-->

                                        <!--<div flex-gt-sm="10" flex-sm="10" flex-xs="15" layout="row" layout-align="end center" >-->

                                            <!--<md-button class="md-icon-button color-fg-primary-500">-->
                                                <!--<i class="material-icons">list</i>-->
                                                <!--<md-tooltip>-->
                                                    <!--Open details-->
                                                <!--</md-tooltip>-->
                                            <!--</md-button>-->

                                        <!--</div>-->

                                    <!--</div>-->

                                <!--</md-list-item> &lt;!&ndash;One filter&ndash;&gt;-->

                                <!--<md-divider ng-repeat-end class="border-width-default color-border-transparent"></md-divider>-->

                            <!--</md-list>-->

                        <!--</div>-->

                    <!--</div>-->

                </md-content>

            </md-tab-body>

        </md-tab>

    </md-tabs>

</div>